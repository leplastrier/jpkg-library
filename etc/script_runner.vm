#!/bin/sh
# This script was autogenerated by the Jpkg Ant task. It runs a series of base64 encoded shell
# scripts in the sequence they appear below.

UUDECODE=`which uudecode`
if [ ! -x $UUDECODE ]; then
    echo "uudecode command could not be run, failing script runner."
    exit 1
fi

#foreach ($script in $scripts)
#### Start of script named "$script.getFriendlyName()"
UUTMPFILE=`mktemp -q /tmp/${script_type}.XXXXXX`
if [ $? -ne 0 ]; then
    echo "$0: Can't create temp file, exiting..."
    exit 1
fi
SHTMPFILE=`mktemp -q /tmp/${script_type}.XXXXXX`
if [ $? -ne 0 ]; then
    echo "$0: Can't create temp file, exiting..."
    exit 1
fi

cat >$UUTMPFILE << EOF
$script.getEncodedSource()
EOF

# decode the base64 encoded script
$UUDECODE -o $SHTMPFILE $UUTMPFILE
EXITCODE=$?
if [ $EXITCODE != 0 ]; then
    echo "uudecoding the \"$script.getFriendlyName()\" script failed."
    rm -f $UUTMPFILE $SHTMPFILE
    exit $EXITCODE
fi

chmod +x $SHTMPFILE

# $* is intentionally not being passed to the encoded scripts to encourage simplicity and consistency with other potential packaging systems. Pass only the type of script being run.
$SHTMPFILE ${script_type}
RESULT=$?

rm $UUTMPFILE $SHTMPFILE

#if ($script.failOnError())
if [ $RESULT != 0 ]; then
    echo "The script \"$script.getFriendlyName()\" failed."
    exit $RESULT
fi
#end
#### End of script named "$script.getFriendlyName()"

#end
